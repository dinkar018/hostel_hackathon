<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hostel Maintenance System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <header class="bg-dark text-white text-center py-3">
    <h2>Hostel Maintenance Request System</h2>
  </header>
  <div class="container mt-5">
    <form id="maintenanceForm">
      <!-- Student ID -->
      <div class="mb-3">
        <label for="username" class="form-label">Student Id</label>
        <input type="text" class="form-control" id="username" name="id" placeholder="Enter your ID" required>
      </div>

      <!-- Hostel Name Dropdown -->
      <div class="mb-3">
        <label for="hostelname" class="form-label">Select your Hostel</label>
        <select class="form-select" id="hostelname" name="hostel" required>
          <option selected disabled>Choose Hostel Name</option>
          <option value="Aryabhatta">Aryabhatta</option>
          <option value="S. Ramanujan">S. Ramanujan</option>
          <option value="M. S. Swaminathan">M. S. Swaminathan</option>
          <option value="V. G. Bhide">V. G. Bhide</option>
          <option value="A. P. J. Abdul Kalam">A. P. J. Abdul Kalam</option>
          <option value="C. V. Raman">C. V. Raman</option>
          <option value="Homi J. Bhabha">Homi J. Bhabha</option>
          <option value="J. C. Bose">J. C. Bose</option>
          <option value="Meghnad Saha">Meghnad Saha</option>
          <option value="Vikram Sarabhai">Vikram Sarabhai</option>
        </select>
      </div>

      <!-- Room Number -->
      <div class="mb-3">
        <label for="roomno" class="form-label">Room Number</label>
        <input type="text" class="form-control" id="roomno" name="roomNumber" placeholder="Ex. F103 / G110" required>
      </div>
      <div class="mb-3">
        <label for="contact" class="form-label">Contact Number</label>
        <input type="text" class="form-control" id="contact" name="contact" placeholder="Enter your contact number" required>
      </div>
      <!-- Complaint Domain Dropdown -->
      <div class="mb-3">
        <label for="domain" class="form-label">Complaint Domain</label>
        <select class="form-select" id="domain" name="domain" required>
          <option selected disabled>Choose Domain</option>
          <option value="civil">Civil</option>
          <option value="electrical">Electrical</option>
          <option value="watercooler">Water Cooler</option>
          <option value="plumbing">Plumbing Fixtures</option>
        </select>
      </div>

      <!-- Subdomain Dropdown -->
      <div class="mb-3">
        <label for="subdomain" class="form-label">Complaint Subdomain</label>
        <select class="form-select" id="subdomain" name="subdomain" required>
          <option selected disabled>Choose Subdomain</option>
        </select>
      </div>

      <!-- Complaint Details -->
      <div class="mb-3">
        <label for="complaintDetails" class="form-label">Complaint Details</label>
        <textarea class="form-control" id="complaintDetails" name="details" rows="4" placeholder="Enter the details of the complaint" required></textarea>
      </div>
      <div class="mb-3">
        <label for="urgency" class="form-label">Urgency Level</label>
        <select class="form-select" id="urgency" name="urgency" required>
          <option selected disabled>Choose Urgency Level</option>
          <option value="Low">Low</option>
          <option value="Medium">Medium</option>
          <option value="High">High</option>
        </select>
      </div>
      <!-- Availability Time -->
      <div class="mb-3">
        <label for="availability" class="form-label">Your Availability Time</label>
        <input type="text" class="form-control" id="availability" name="availabilityTime" placeholder="Ex. 2 p.m to 4 p.m" required>
      </div>

      <!-- Submit and Reset Buttons -->
      <div class="d-flex justify-content-between">
        <button type="submit" class="btn btn-primary">Submit</button>
        <button type="reset" class="btn btn-secondary">Reset</button>
      </div>
      <!-- Contact Number -->


<!-- Complaint Urgency -->


    </form> 
  </div>

  <footer class="bg-dark text-white text-center py-3 mt-5">
    <p class="mb-1">Copyright Â© 2025 VNIT Nagpur.</p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
  const domainDropdown = document.getElementById('domain');
  const subdomainDropdown = document.getElementById('subdomain');

  // Mapping domains to their respective subdomains
  const domainSubdomainMap = {
    civil: [
      { value: 'wallcrack', text: 'Wall Crack' },
      { value: 'roofleak', text: 'Roof Leakage' },
      { value: 'floorissues', text: 'Floor Issues' },
    ],
    electrical: [
      { value: 'poweroutage', text: 'Power Outage' },
      { value: 'lighting', text: 'Lighting Issues' },
      { value: 'shortcircuit', text: 'Short Circuit' },
    ],
    watercooler: [
      { value: 'notcooling', text: 'Not Cooling' },
      { value: 'leakage', text: 'Water Leakage' },
      { value: 'noiseissue', text: 'Noise Issue' },
    ],
    plumbing: [
      { value: 'pipeleak', text: 'Pipe Leakage' },
      { value: 'cloggeddrain', text: 'Clogged Drain' },
      { value: 'faucetissues', text: 'Faucet Issues' },
    ],
  };

  // Update subdomain options based on selected domain
  domainDropdown.addEventListener('change', () => {
    const domain = domainDropdown.value;
    subdomainDropdown.innerHTML = '<option selected disabled>Choose Subdomain</option>'; // Reset subdomain options

    if (domainSubdomainMap[domain]) {
      domainSubdomainMap[domain].forEach((sub) => {
        const option = document.createElement('option');
        option.value = sub.value;
        option.textContent = sub.text;
        subdomainDropdown.appendChild(option);
      });
    }
  });
});

    document.getElementById('maintenanceForm').addEventListener('submit', async function(event) {
  event.preventDefault();
  const formData = {
    id: document.getElementById('username').value,
    hostel: document.getElementById('hostelname').value,
    roomNumber: document.getElementById('roomno').value,
    contact: document.getElementById('contact').value,
    domain: document.getElementById('domain').value,
    subdomain: document.getElementById('subdomain').value,
    details: document.getElementById('complaintDetails').value,
    urgency: document.getElementById('urgency').value,
    Time: document.getElementById('availability').value,
  };

  try {
    const response = await fetch('http://localhost:3000/complain', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(formData),
    });

    if (response.ok) {
      alert('Request submitted successfully!');
    } else {
      alert('Failed to submit request.');
    }
  } catch (error) {
    console.error('Error:', error);
    alert('An error occurred while submitting the request.');
  }
});
  </script>
</body>
</html>