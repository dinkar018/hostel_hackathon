<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hostel Maintenance System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <header class="bg-dark text-white text-center py-3">
    <h2>Hostel Maintenance Request System</h2>
  </header>
  <div class="container mt-5">
    <form id="maintenanceForm">
      <!-- Student ID -->
      <div class="mb-3">
        <label for="username" class="form-label">Student Id</label>
        <input type="text" class="form-control" id="username" name="id" placeholder="Enter your ID" required>
      </div>

      <!-- Hostel Name Dropdown -->
      <div class="mb-3">
        <label for="hostelname" class="form-label">Select your Hostel</label>
        <select class="form-select" id="hostelname" name="hostel" required>
          <option selected disabled>Choose Hostel Name</option>
          <option value="Aryabhatta">Aryabhatta</option>
          <option value="S. Ramanujan">S. Ramanujan</option>
          <option value="M. S. Swaminathan">M. S. Swaminathan</option>
          <option value="V. G. Bhide">V. G. Bhide</option>
          <option value="A. P. J. Abdul Kalam">A. P. J. Abdul Kalam</option>
          <option value="C. V. Raman">C. V. Raman</option>
          <option value="Homi J. Bhabha">Homi J. Bhabha</option>
          <option value="J. C. Bose">J. C. Bose</option>
          <option value="Meghnad Saha">Meghnad Saha</option>
          <option value="Vikram Sarabhai">Vikram Sarabhai</option>
        </select>
      </div>

      <!-- Room Number -->
      <div class="mb-3">
        <label for="roomno" class="form-label">Room Number</label>
        <input type="text" class="form-control" id="roomno" name="roomNumber" placeholder="Ex. F103 / G110" required>
      </div>

      <!-- Complaint Domain Dropdown -->
      <div class="mb-3">
        <label for="domain" class="form-label">Complaint Domain</label>
        <select class="form-select" id="domain" name="domain" required>
          <option selected disabled>Choose Domain</option>
          <option value="civil">Civil</option>
          <option value="electrical">Electrical</option>
          <option value="watercooler">Water Cooler</option>
          <option value="plumbing">Plumbing Fixtures</option>
        </select>
      </div>

      <!-- Subdomain Dropdown -->
      <div class="mb-3">
        <label for="subdomain" class="form-label">Complaint Subdomain</label>
        <select class="form-select" id="subdomain" name="subdomain" required>
          <option selected disabled>Choose Subdomain</option>
        </select>
      </div>

      <!-- Complaint Details -->
      <div class="mb-3">
        <label for="complaintDetails" class="form-label">Complaint Details</label>
        <textarea class="form-control" id="complaintDetails" name="details" rows="4" placeholder="Enter the details of the complaint" required></textarea>
      </div>

      <!-- Availability Time -->
      <div class="mb-3">
        <label for="availability" class="form-label">Your Availability Time</label>
        <input type="text" class="form-control" id="availability" name="availabilityTime" placeholder="Ex. 2 p.m to 4 p.m" required>
      </div>

      <!-- Submit and Reset Buttons -->
      <div class="d-flex justify-content-between">
        <button type="submit" class="btn btn-primary">Submit</button>
        <button type="reset" class="btn btn-secondary">Reset</button>
      </div>
    </form> 
  </div>

  <footer class="bg-dark text-white text-center py-3 mt-5">
    <p class="mb-1">Copyright Â© 2025 VNIT Nagpur.</p>
  </footer>

  <script>
    document.getElementById('maintenanceForm').addEventListener('submit', async function(event) {
      event.preventDefault();
      const formData = {
        id: document.getElementById('username').value,
        hostel: document.getElementById('hostelname').value,
        roomNumber: document.getElementById('roomno').value,
        domain: document.getElementById('domain').value,
        subdomain: document.getElementById('subdomain').value,
        details: document.getElementById('complaintDetails').value,
        availabilityTime: document.getElementById('availability').value,
      };

      try {
        const response = await fetch('http://localhost:3000/complain', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(formData),
        });

        if (response.ok) {
          alert('Request submitted successfully!');
        } else {
          alert('Failed to submit request.');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while submitting the request.');

      }
    });

    document.getElementById('domain').addEventListener('change', function() {
      var subdomain = document.getElementById('subdomain');
      subdomain.innerHTML = '<option value="" disabled selected>Choose Subdomain</option>';
      var options = [];
      if (this.value === 'civil') {
        options = ['Structural', 'Masonry', 'Concrete'];
      } else if (this.value === 'electrical') {
        options = ['Wiring', 'Appliances'];
      } else if (this.value === 'watercooler') {
        options = ['Dispenser', 'Cooling'];
      } else if (this.value === 'plumbing') {
        options = ['Pipes', 'Fixtures'];
      }
      for (var i = 0; i < options.length; i++) {
        var opt = document.createElement('option');
        opt.value = options[i];
        opt.innerHTML = options[i];
        subdomain.appendChild(opt);
      }
    });
  </script>
</body>
</html>